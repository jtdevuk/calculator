<!DOCTYPE html>
<html>
    <head>
        <title>Calculator</title>
        <link rel="stylesheet", type="text/css", href="style.css">
    </head>
    <body>

        <div id="calculator">
            <div id="display">0</div>
            <div id="button-container">
                <div class="button" id="clear" data-value="">
                    <span>C</span>
                </div>
                <div class="button" id="delete" data-value="">
                    <img src="backspace.png">
                </div>                
                <div class="button" id="divide" data-value="/" data-display="รท" data-type="operator">
                    <span>รท</span>
                </div>
                <div class="button" id="times" data-value="*" data-display="x" data-type="operator">
                    <span>x</span>
                </div>                
                <div class="button" id="minus" data-value="-" data-display="-" data-type="operator">
                    <span>-</span>
                </div>
                <div class="button" id="plus" data-value="+" data-display="+" data-type="operator">
                    <span>+</span>
                </div>
                <div class="button" id="seven" data-value="7" data-type="number">
                    <span>7</span>
                </div>
                <div class="button" id="eight" data-value="8" data-type="number">
                    <span>8</span>
                </div>
                <div class="button" id="nine" data-value="9" data-type="number">
                    <span>9</span>
                </div>
                <div class="button" id="four" data-value="4" data-type="number">
                    <span>4</span>
                </div>
                <div class="button" id="five" data-value="5" data-type="number">
                    <span>5</span>
                </div>
                <div class="button" id="six" data-value="6" data-type="number">
                    <span>6</span>
                </div>
                <div class="button" id="one" data-value="1" data-type="number">
                    <span>1</span>
                </div>
                <div class="button" id="two" data-value="2" data-type="number">
                    <span>2</span>
                </div>
                <div class="button" id="three" data-value="3" data-type="number">
                    <span>3</span>
                </div>
                <div class="button" id="zero" data-value="0" data-type="number">
                    <span>0</span>
                </div>
                <div class="button" id="point" data-value=".">
                    <span>.</span>
                </div>
                <div class="button" id="equals" data-value="=">
                    <span>=</span>
                </div>                
            </div>
        </div>
        <p>Created by <a href="www.github.com">jtdevuk </a>2020</p>
        Icons made by <a href="https://www.flaticon.com/authors/prettycons" title="prettycons">prettycons</a> from <a href="https://www.flaticon.com/" title="Flaticon"> www.flaticon.com</a>
        <script>

           const display = document.querySelector('#display');
        //    const button = document.querySelector('#one');
           const buttons = document.querySelectorAll('.button');                            
           let operatorPresent = false;
           let operatorValue = ""
           let num1 = 0;
           let num2 = 0;                    
        
           buttons.forEach(function(button){

                button.addEventListener("click", function() {  
                    
                    if(display.innerHTML.length < 27) {

                        if(this.id=='clear') clear();
                        if(this.id=='delete') del();

                        if(this.getAttribute('data-type') == 'number' || this.getAttribute('data-value') == '.') {                        
                            
                            if(operatorValue == "") {
                                
                                if(num1 == 0) {
                                    display.innerHTML = "";
                                    num1 = this.getAttribute('data-value');
                                } else {
                                    num1 += this.getAttribute('data-value');
                                }
                                
                            } else {

                                if(num2 == 0) {                                
                                    num2 = this.getAttribute('data-value');
                                } else {
                                    num2 += this.getAttribute('data-value');
                                }                          
                            }

                            //could this be changed to display.innerHTML= num1?
                            display.innerHTML += this.getAttribute('data-value');
                            operatorPresent = false;                       
                        }
                        
                        if(this.getAttribute('data-type') == 'operator') {

                            //add ability to adjust operator?
                            if(operatorPresent == true) {                            
                                return;
                            }
                            
                            if(operatorValue == "") {                        
                                operatorValue = this.getAttribute('data-value');
                                operatorPresent = true;
                                display.innerHTML = num1 + this.getAttribute('data-display');                            

                            } else if(operatorValue != "") {
                                
                                num1 = operate(num1, num2, operatorValue);
                                num2 = 0;
                                display.innerHTML = +num1.toFixed(5) + this.getAttribute('data-display');
                                operatorValue = this.getAttribute('data-value');
                                operatorPresent = true;                         
                            }            
                        }

                        if(this.getAttribute('data-value') == '=') {
                            
                            if(operatorValue == "") {
                                return num1;
                            }

                            num1 = operate(num1, num2, operatorValue);
                            num2 = 0;

                            //+ in front of num1 converts it back into a number, and any un-necessary decimal places are removed
                            display.innerHTML = +num1.toFixed(5);
                            
                            operatorValue = "";
                        }

                        display.innerHTML.length >= 13 ? display.style.fontSize = '30px' : display.style.fontSize = '60px'
                    } else {
                        if(this.id=='clear') clear();
                        if(this.id=='delete') del();
                    }
                });
            
            });            

            let clear = () => {
                operatorPresent = false;
                operatorValue = "";                
                display.style.fontSize = '60px';
                displayCount = 0;
                num1 = 0;
                num2 = 0;
                return display.innerHTML = "0";                
            }

            let del = () => {
                operatorPresent = false;
                display.innerHTML = display.innerHTML.slice(0, -1)
                num1 = display.innerHTML                
                
                if(display.innerHTML.length == 0) display.innerHTML = "0";                
                        
                if(displayCount > 1) {                                
                    displayCount -=1;
                } else {
                    displayCount = 0                    
                }
                if(displayCount <= 13) {
                    display.style.fontSize = '60px';
                } 
            }

           let add = (a, b) => parseFloat(a) + parseFloat(b);
           let subtract = (a, b) => a - b;
           let multiply = (a, b) => a * b;
           let divide = (a, b) => a / b;

           let operate = (a, b, operator) => {               
                
                if(operator == '+') return (add(a,b));                
                if(operator == '-') return (subtract(a,b));
                if(operator == '*') return (multiply(a,b));
                if(operator == '/') return (divide(a,b));
           }           
                     
           // . can be entered several times in a row
           //. can be entered in more than one location in a number
           
        </script>
    </body>
</html>
